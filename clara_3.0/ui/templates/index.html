<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Clara Document Processor</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .container { display:flex; gap:20px; }
    .left { flex:1; }
    .right { flex:1; background:#f7f7f7; padding:10px; border-radius:6px; }
    pre { white-space: pre-wrap; word-wrap: break-word; }
  </style>
</head>
<body>
  <h1>Upload Document</h1>
  <form id="uploadForm" enctype="multipart/form-data">
    <input type="file" id="file" name="file" accept=".pdf,.png,.jpeg,.jpg"/><br/><br/>
    <button type="submit">Process</button>
  </form>
  <div class="container" style="margin-top:20px;">
    <div class="left">
      <h3>Preview</h3>
      <iframe id="preview" width="100%" height="600" style="display:none;"></iframe>
    </div>
    <div class="right">
      <h3>Result JSON</h3>
      <pre id="result">No result yet</pre>
      <div id="links"></div>
    </div>
  </div>
<script>
const form = document.getElementById('uploadForm');
form.onsubmit = async (e) => {
  e.preventDefault();
  const file = document.getElementById('file').files[0];
  if(!file){ alert("Choose a file"); return; }
  const fd = new FormData();
  fd.append('file', file);
  document.getElementById('result').textContent = "Processing..."
  const res = await fetch('/api/upload', { method:'POST', body: fd });
  const json = await res.json();
  document.getElementById('result').textContent = JSON.stringify(json, null, 2);
  if(json && json.downloadZip){
    const links = document.getElementById('links');
    links.innerHTML = `<a href="${json.downloadZip}">Download ZIP</a>`;
  }
  if(file.type === 'application/pdf'){
    const url = URL.createObjectURL(file);
    const frame = document.getElementById('preview');
    frame.src = url;
    frame.style.display = 'block';
  }
}
</script>
</body>
</html>
